<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Terminal LMS{% endblock %}</title>
    <meta name="csrf-token" content="{{ csrf_token }}">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="{% static 'css/blog.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,0,1;wght@300;400;500;700&family=Ubuntu+Mono:ital,0,1;wght@400;700&display=swap" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<body>
    {% csrf_token %}
    <div class="page-header">
        <h1><a href="{% url 'landing' %}">⚡ Terminal LMS</a></h1>
        <div class="top-menu">
            <span class="zulu-time">ZULU: <span id="watch">--:--:--:---</span></span>
            {% if user.is_authenticated %}
                <span>user@lms:~$ whoami → {{ user.username }}</span>
                <a href="{% url 'forum_list' %}" class="btn btn-default">forums</a>
                <a href="{% url 'all_blogs' %}" class="btn btn-default">blogs</a>
                <a href="{% url 'my_blog_dashboard' %}" class="btn btn-default">my blog</a>
                {% if user.is_staff and user.is_superuser %}
                    <a href="/admin/" class="btn btn-default">admin</a>
                {% else %}
                    {% if user.userprofile.role == 'instructor' %}
                        <a href="{% url 'instructor_dashboard' %}" class="btn btn-default">dashboard</a>
                    {% else %}
                        <a href="{% url 'student_dashboard' %}" class="btn btn-default">dashboard</a>
                    {% endif %}
                {% endif %}
                <a href="{% url 'logout' %}" class="btn btn-default">logout</a>
            {% else %}
                <a href="{% url 'login' %}" class="btn btn-default">login</a>
                <a href="{% url 'register' %}" class="btn btn-default">register</a>
            {% endif %}
        </div>
    </div>

    {% block content %}
    {% endblock %}

    <!-- Floating Blog Access Button -->
    {% if user.is_authenticated %}
    <div class="floating-blog-access">
        <div class="fab-main">
            <i class="fa fa-plus"></i>
        </div>
        <div class="fab-menu">
            <a href="{% url 'create_blog_post' %}" class="fab-item" title="Write New Blog Post">
                <i class="fa fa-edit"></i>
            </a>
            <a href="{% url 'my_blog_dashboard' %}" class="fab-item" title="My Blog Dashboard">
                <i class="fa fa-dashboard"></i>
            </a>
            <a href="{% url 'user_profile' user.username %}" class="fab-item" title="My Profile">
                <i class="fa fa-user"></i>
            </a>
            <a href="{% url 'all_blogs' %}" class="fab-item" title="Browse All Blogs">
                <i class="fa fa-globe"></i>
            </a>
        </div>
    </div>
    {% endif %}

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    
    <!-- MathJax for Math Equation Rendering -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'tex2jax_ignore'
            }
        };
    </script>
    
    <script src="{% static 'js/theme-switcher.js' %}"></script>
    
    <!-- ZULU/GMT Time Clock -->
    <script>
        function ActualTime() {
            var now = new Date();
            // Get UTC time components
            var hours = now.getUTCHours();
            var minutes = now.getUTCMinutes();
            var seconds = now.getUTCSeconds();
            var milliseconds = now.getUTCMilliseconds();
            
            minutes = actualizeTime(minutes);
            seconds = actualizeTime(seconds);
            // Format milliseconds to 3 digits
            milliseconds = String(milliseconds).padStart(3, '0');
            
            document.getElementById('watch').innerHTML =
                hours + ":" + minutes + ":" + seconds + ":" + milliseconds;
            var timer = setTimeout(ActualTime, 1);
        }
        
        function actualizeTime(i) {
            if (i < 10) {i = "0" + i}
            return i;
        }
        
        // Start the clock when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            ActualTime();
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>